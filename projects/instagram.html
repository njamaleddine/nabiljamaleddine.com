<!DOCTYPE html>
<html lang="en">
	<head>
	<meta charset="utf-8">	
	<title>Nabil's Portfolio / Projects / Instagram Image Search</title>
	<link rel="icon" href="/favicon.png" />
    <link rel="apple-touch-icon-precomposed" href="/favicon.png" />
    <link rel="stylesheet" type="text/css" href="/projects/css/instagram.css" />
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	</head>
	<body>
		<div id="container">
			<h1 id="title">Search results for </h1>
			<input type="button" id="redo-search" value="Redo Search"/>
			<div id="search-results"></div>
			<script type="text/javascript">
				/*Sanitize html*/
				function escapeHtml(text) {
				  return text
				      .replace(/&/g, "&amp;")
				      .replace(/</g, "&lt;")
				      .replace(/>/g, "&gt;")
				      .replace(/"/g, "&quot;")
				      .replace(/'/g, "&#039;");
				}

				var tag = prompt("Type a hashtag for images you would like to search on Instagram:");

				//eliminate searching for "#null" if user inputs nothing
				if(tag === null){
					tag ="";
					$(function(){
						$('#container').css("visibility", "visible"); 
					});
				}
				//Remove unnecessary extra hashtag user might input
				if(tag.substring(0,1) === "#"){
					tag=tag.substring(1,tag.length);
				}

				//Sanitize if html tags were put in
				tag = escapeHtml(tag);

				$(function(){
						$('#container').css("visibility", "visible"),
						$('#title').append("<span>#"+tag+"</span>:"),

						clientId = 'b6a8f5f21e4342ffa056d575d49f573b'

						$.ajax({
							type: "GET",
					        dataType: "jsonp",
					        url: "https://api.instagram.com/v1/tags/"+tag+"/media/recent?client_id="+clientId,
							data: {
								client_id: clientId
							},
							success: function(response)  {
					            $.each(response.data, function(i, e) {
					                $("#search-results").append("<a target='_blank' class='photo' href='" + e.link +"'><img src='" + e.images.low_resolution.url +"'/></a>");
					            });
					        }
						});
				});
				$('#redo-search').click(function() {
    				location.reload();
				});
			</script>
		</div>
	</body>
</html>